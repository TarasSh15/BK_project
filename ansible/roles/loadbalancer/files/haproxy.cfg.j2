global
        log /dev/log    local0
        log /dev/log    local1 notice
        chroot /var/lib/haproxy
        stats socket /run/haproxy/admin.sock mode 660 level admin expose-fd listeners
        stats timeout 30s
        user haproxy
        group haproxy
        daemon

defaults
        log     global
        mode    tcp
        option  tcplog
        option  dontlognull
        retries 3
        timeout http-request 10s
        timeout queue   1m
        timeout connect 10s
        timeout client  1m
        timeout server  1m
        timeout check 10s
        maxconn 3000

frontend ssh-connserv1
        bind *:2222 
        mode tcp
        default_backend ssh-all

{% for master in groups['web-apps'] %}
backend {{hostvars[master].inventory_hostname}}
   mode tcp
   server ubuntu {{hostvars[master].ansible_host}}:22 check
{% endfor %}